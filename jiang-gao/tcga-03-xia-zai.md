# TCGA 03 下载

各位学员大家好，我是麦子，欢迎来到解螺旋单元课第5期，TCGA肿瘤数据库使用教程。本视频是TCGA肿瘤数据库使用教程操作演示的第三个视频，内容对应PPT教程中的第4章，核心功能，数据下载。

PPT中介绍了三种下载方法，分别是从购物车下载、利用TCGA官方提供的工具下载，此外还有第三方开发的种种工具，我们介绍R语言下载的方法之一。下面一一来看。

上次课中我们说到，Repository既可以检索，也可以下载。可以在Project或Exploratory界面检索好之后，转到Repository页面，也可以直接在Repository页面检索。

检索条件在左边面板，右上方的饼图，既是数据可视化，也可以当作检索条件来点选。下方是文件信息。我们点开饼图下的show more，查看所有的饼图。如果目标就是下载数据的话，我们免费用户，可以干脆直接在权限等级的饼图上点上open，再看其他条件。

比如我们选择TCGA-LUAD项目，肺腺癌，再选择RNA-seq，得到1782个文件。点击一个文件前的购物车按钮，即选中，供后续下载。或者点上方购物车的下拉菜单，全部添加到购物车。

我们就选三个counts文件来演示。选好后点击右上角的购物车图标，检查文件数量、项目来源等信息，确认好之后可以点Download，Chart下载。

这个方法适合少量数据。

第二种使用TCGA官方提供的GDC工具。在网页右上角点GDC App，Data Transfer Tool。

在新的网页中往下拉，到Binary Distributions段落，选择合适自己操作系统的版本进行下载，本视频采用windows版本。上一个段落就是对设备配置的推荐，也可以参考PPT上的翻译。今后如果需要处理较多数据的话，还是建议大家选择好一点的设备。

下载好之后将其解压，得到一个exe文件，无需再行安装，但要将它所在位置添加到环境变量中。

接下来，PPT演示的是Win7系统，而本视频演示的是Win10，应当大同小异。在桌面“此电脑”右键，属性，高级系统设置，点开高级选项卡，点环境变量，在用户变量中找到Path。我这里因为以前已经创建过path，所以直接点它即可，如果大家本来没有path，就像PPT教程中，新建即可。

将gdc所在的文件夹路径复制，比如我这里就是C盘的Program Files。在path中新建变量值，粘贴进来。一直点确定，将其保存。这样gdc就可以使用了。

我们用命令行运行它。按下windows + R，输入cmd。在弹出的命令行窗口中，输入gdc杠client，空格，杠h，回车运行，出现如下界面，就是成功启动了gdc，可以下载数据。

操作提示符前面的路径就是当前工作路径，数据将会下载到这里，要确保这里有足够的空间。现在我们将其改到D盘下的TCGA文件夹。输入命令，cd，空格，反斜杠d，空格，接着输入路径，或者粘贴过来。回车。这时操作符前面的路径就变成了我们设的这个。

我们回到TCGA网站的购物车页面，刚才的Download下拉列表里，选择manifest，即得到一个txt文件。具体内容就像PPT展示的这样，是购物车里的数据，实际上我们不需要打开这个文件。

回到gdc，输入命令，gdc杠client，空格，download，空格，杠m，再空格，把manifest文件名给贴上，不要忘了扩展名。如果你的manifest文件不在前边所示的文件夹里，就要把完整的路径写上。

回车之后，就等待下载。最后会提示下载成功3个文件。

教程上还有一种UUID号的下载方法，与manifest大同小异，就不演示了。如果需要下载较多数据，还是用manifest比较好。

这样下载回来的三个样本的文件分别存在三个文件夹里，点开，里面还有个压缩文件，这里面才是我们的目标文件，但是，要把它们整合起来才能做后续分析，可见整合也是件很麻烦的事，如果掌握一些的编程技巧就可以提高效率。

第三种方法是用R语言下载。R语言里面也有好几种方法，我们这里介绍的RTCGAToolbox包，相对来说比较简单，下载回来的数据是已经整理好的。但仍然需要一定的R语言基础。如果大家有需要，可以参考我们其他的R语言相关课程去学习基础概念，这里不再介绍。

我先切换到mac系统。因为这个包与Mac的兼容性更好些，我们先看看它的正常流程。

需要提醒的是，RTCGAToolbox包的安装，在我们教程上是source和biocLite这两句，可是到了制作本视频时，bioconductor已经有了更新，现在是3.8版本了，所以我们在它的主页上找到这两句命令，复制过来运行安装即可。如果原先安装过了则不必理会。

安装好之后，运行library这句，载入工具包，才开始使用。

下载之前，我们先运行getwd括号，查看当前的工作路径，待会下载数据时，将会下载到这里，所以确保这个地方有足够的空间。如果想要更改的话，可以通过setwd，括号里面照这个格式填上路径名称即可，注意斜杠的方向。

准备好之后，即可查看Data这一句。这是用getFirehosedata，这个函数，来下载数据，括号里面需要指定TCGA数据集的名称。因为这个函数下载的来源是博大研究院将TCGA数据定期整理后的归档版本，所以还要指定整理的日期。

如果不知道有哪些数据集、哪些日期可用，可以分别运行getFirehosedatasets和getFirehoserunningDates来查看。

当前演示选用的是BRCA，乳腺癌，20140115版本。数据选择了临床、RNASeq、mRNA芯片，还有突变Mutation的数据，将这些参数设为True，如果不需要就可以不写，因为默认就是FALSE。

其他可选的参数可以参考PPT中这一页的说明，或者，在RStudio的help窗口，查阅getfirehosedata函数的官方文档。

但注意，并不是每种肿瘤都有全部的数据类型可供下载，先查阅前一页的数据汇总表，看看自己感兴趣的肿瘤都有哪些数据类型。

这句确定之后就可以运行。

我这里同时展示RStudio的窗口和工作路径文件夹，让大家看看下载过程中，文件夹内容会随着R的处理进程发生什么变化。

现在在下载mRNAArray这份数据，可见到它在自动解压缩，修改文件名，删掉原来的压缩文件。之所以提醒大家注意是因为，有很多小伙伴是使用windows系统，这个包在windows上运行会卡在这一步，无法解压缩或无法重命名，所以PPT教程上才会教大家多做一步，手动重命名。

所以windows用户如果想用这个包，可以像PPT教程这样多一步操作，也可以装一个mac虚拟机，或者装黑苹果等等，或者买苹果电脑。总之办法有的是。

下载好之后我们得到一个Data对像，里面就把刚才我们选的临床、RNASeqGene、mRNAArray、Mutation等等都整个在一起。点开蓝色小箭头就可以预览。

这个数据集就可以用来做后续的分析。退出时记得保存工作工间，这样下节课再打开时就可以直接使用。如果忘了也不要紧，大不了下回再花点时间运行一次这句就是了。

好了，关于TCGA数据下载，我们就演示到这里，下一节我们将演示，利用R语言进行分析。

